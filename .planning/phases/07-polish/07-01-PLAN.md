---
phase: 07-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli.ts
  - src/lib/ui/success-screen.ts
  - src/lib/ui/progress-reporter.ts
  - src/lib/ui/types.ts
autonomous: true

must_haves:
  truths:
    - "User sees ASCII art success screen after successful installation"
    - "Success screen shows commands installed count, next steps, and installation summary"
    - "User can run with --quiet to suppress output except final result"
    - "User can run with --verbose to see detailed step-by-step progress"
    - "Progress messages show per-step timing (e.g., 'Transpiling... (1.2s)')"
    - "Terminal colors enhance readability when supported"
  artifacts:
    - path: "src/lib/ui/types.ts"
      provides: "Type definitions for UI components"
      min_lines: 20
      exports: ["VerbosityLevel", "ProgressStep", "SuccessScreenData"]
    - path: "src/lib/ui/success-screen.ts"
      provides: "Success screen renderer with ASCII art"
      min_lines: 80
      exports: ["renderSuccessScreen"]
    - path: "src/lib/ui/progress-reporter.ts"
      provides: "Progress reporter with timing and colors"
      min_lines: 60
      exports: ["ProgressReporter"]
    - path: "src/cli.ts"
      provides: "CLI with --quiet/--verbose flags and enhanced output"
      contains: "new ProgressReporter"
  key_links:
    - from: "src/cli.ts"
      to: "src/lib/ui/progress-reporter.ts"
      via: "instantiate ProgressReporter"
      pattern: "new ProgressReporter\\(verbosity\\)"
    - from: "src/cli.ts"
      to: "src/lib/ui/success-screen.ts"
      via: "call renderSuccessScreen"
      pattern: "renderSuccessScreen\\("
    - from: "src/lib/ui/progress-reporter.ts"
      to: "picocolors"
      via: "import for terminal colors"
      pattern: "import.*picocolors"
---

<objective>
Create visually appealing success screen with ASCII art and enhance progress reporting with colors, timing, and verbosity controls. This transforms the installer UX from plain console.log output to a polished, professional CLI experience.

**Purpose:** Deliver excellent UX that makes the installer feel responsive, rewarding, and trustworthy

**Output:** Success screen renderer, progress reporter with timing/colors, and --quiet/--verbose CLI flags
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-polish/07-CONTEXT.md

# Current CLI implementation
@src/cli.ts

# Package dependencies
@package.json
</context>

<tasks>

<task type="auto">
  <name>Create UI type definitions</name>
  <files>src/lib/ui/types.ts</files>
  <action>
Create type definitions for UI components.

**Types to define:**

```typescript
export enum VerbosityLevel {
  QUIET = 0,   // Only final result
  NORMAL = 1,  // Default - moderate output
  VERBOSE = 2  // Full detail
}

export interface ProgressStep {
  name: string;
  startTime: number;
  endTime?: number;
}

export interface SuccessScreenData {
  commandsInstalled: number;
  gsdPath: string;
  opencodePath: string;
  cacheStatus: 'fresh' | 'stale' | 'unavailable';
  partialSuccess: boolean;
  failedCount?: number;
  warningCount?: number;
}

export interface InstallationStats {
  totalTime: number;
  steps: ProgressStep[];
}
```

Use clean TypeScript conventions. This is a new file in a new directory.
  </action>
  <verify>
File exists and exports VerbosityLevel enum and all interfaces. Run: `grep -E "export (enum|interface)" src/lib/ui/types.ts`
  </verify>
  <done>
Type definitions exist for VerbosityLevel, ProgressStep, SuccessScreenData, and InstallationStats
  </done>
</task>

<task type="auto">
  <name>Create success screen renderer</name>
  <files>src/lib/ui/success-screen.ts</files>
  <action>
Create success screen renderer with ASCII art, disclaimer, and next steps.

**Implementation requirements:**

1. **ASCII art:** Use celebration graphic (rocket ship recommended for energy/launch metaphor)
2. **Color support:** Use picocolors for green (success), bold (emphasis), dim (subdued text)
3. **Terminal detection:** Check terminal capabilities before applying colors
4. **Content sections:**
   - ASCII art header
   - Success message with command count
   - Installation summary (GSD path, OpenCode path, cache status)
   - Next steps instruction
   - Disclaimer about best-effort migration
   - Tip about re-running for updates

5. **Partial success variant:** Different messaging when some commands failed
   - Use warning colors (yellow) instead of pure green
   - Show failed count prominently
   - Add log reference for troubleshooting

**Function signature:**
```typescript
export function renderSuccessScreen(data: SuccessScreenData): void {
  // Use picocolors for terminal colors
  // Check if terminal supports colors before applying
  // Show full success or partial success variant based on data
}
```

**Example output structure:**
```
    ðŸš€
   /|\
  / | \

âœ“ Installation Complete!

Installed 23 GSD commands

Installation Details:
  GSD: ~/.claude/get-shit-done/
  OpenCode: ~/.config/opencode/
  Docs Cache: Fresh

Next Steps:
  Run /gsdo in OpenCode to enhance commands

Note: This is a best-effort migration. Review commands before use.

Tip: Run 'npx gsd-open' again anytime to update
```

Use proper line breaks, spacing, and alignment for visual appeal. ASCII art should be simple and terminal-safe.
  </action>
  <verify>
File exists and exports renderSuccessScreen function. Test render: `npm run dev -- --help` (check no crashes). Check picocolors import present.
  </verify>
  <done>
renderSuccessScreen function exists, uses picocolors, handles both full and partial success, displays ASCII art and all required content sections
  </done>
</task>

<task type="auto">
  <name>Create progress reporter with timing</name>
  <files>src/lib/ui/progress-reporter.ts</files>
  <action>
Create ProgressReporter class that tracks timing and formats output based on verbosity.

**Implementation requirements:**

1. **Class structure:**
```typescript
export class ProgressReporter {
  private verbosity: VerbosityLevel;
  private steps: ProgressStep[] = [];
  private currentStep: ProgressStep | null = null;

  constructor(verbosity: VerbosityLevel) {
    this.verbosity = verbosity;
  }

  startStep(name: string): void {
    // Record step start time
    // In VERBOSE mode, log immediately
    // In NORMAL mode, log without details
    // In QUIET mode, skip
  }

  endStep(): void {
    // Calculate duration
    // Log completion with timing in NORMAL/VERBOSE
  }

  log(message: string, level: 'info' | 'success' | 'warning' | 'error' = 'info'): void {
    // Respect verbosity setting
    // Apply colors based on level (green=success, yellow=warning, red=error)
  }

  getFinalStats(): InstallationStats {
    // Return timing statistics
  }
}
```

2. **Timing format:** Show seconds with 1 decimal place (e.g., "1.2s")
3. **Color mapping:**
   - info: no color (default)
   - success: green
   - warning: yellow
   - error: red

4. **Verbosity behavior:**
   - QUIET: Only log errors and final result
   - NORMAL: Log step completions with timing
   - VERBOSE: Log every action immediately

Use picocolors for colors, check terminal support.
  </action>
  <verify>
File exists and exports ProgressReporter class. Check constructor takes VerbosityLevel, has startStep/endStep/log methods. Run: `grep -E "export class ProgressReporter" src/lib/ui/progress-reporter.ts`
  </verify>
  <done>
ProgressReporter class exists with timing tracking, verbosity-aware logging, color support via picocolors, and timing statistics
  </done>
</task>

<task type="auto">
  <name>Integrate progress reporter and success screen into CLI</name>
  <files>src/cli.ts</files>
  <action>
Replace console.log statements with ProgressReporter and add success screen rendering.

**Changes required:**

1. **Parse CLI flags:**
```typescript
const forceRefresh = process.argv.includes('--force');
const quiet = process.argv.includes('--quiet');
const verbose = process.argv.includes('--verbose') || process.argv.includes('-v');

const verbosity = quiet ? VerbosityLevel.QUIET :
                  verbose ? VerbosityLevel.VERBOSE :
                  VerbosityLevel.NORMAL;
```

2. **Instantiate ProgressReporter:**
```typescript
const progress = new ProgressReporter(verbosity);
```

3. **Replace console.log calls with progress methods:**
   - `console.log('â†’ Detecting...')` â†’ `progress.startStep('Detecting GSD installation')`
   - `console.log('  âœ“ Found...')` â†’ `progress.log('Found at ' + path, 'success'); progress.endStep()`
   - Keep console.error for errors (those bypass progress reporter)

4. **Add success screen at end:**
```typescript
// Before: console.log('\nâœ“ Installation complete');
// After:
const successData: SuccessScreenData = {
  commandsInstalled: transpileResult.successful.length + 1, // +1 for /gsdo
  gsdPath: gsdResult.path!,
  opencodePath: opencodeResult.path!,
  cacheStatus: cacheResult.cached ? (cacheResult.stale ? 'stale' : 'fresh') : 'unavailable',
  partialSuccess: transpileResult.failed.length > 0,
  failedCount: transpileResult.failed.length,
  warningCount: transpileResult.warnings.length
};

renderSuccessScreen(successData);
```

5. **Import statements:**
```typescript
import { ProgressReporter } from './lib/ui/progress-reporter.js';
import { renderSuccessScreen } from './lib/ui/success-screen.js';
import { VerbosityLevel } from './lib/ui/types.js';
```

6. **Keep existing logic intact:** Don't change detection, transpilation, or enhancement logic - only replace output statements.

7. **Preserve error handling:** console.error and process.exit calls stay unchanged.
  </action>
  <verify>
CLI compiles without errors. Run: `npm run build`. Test with `npm run dev` and verify progress output appears. Test `npm run dev -- --quiet` shows minimal output.
  </verify>
  <done>
CLI uses ProgressReporter for all progress output, parses --quiet/--verbose flags, shows success screen at end, and all existing functionality works unchanged
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - compiles without errors
2. Run `npm run dev` - shows enhanced progress with colors and timing
3. Run `npm run dev -- --quiet` - shows minimal output
4. Run `npm run dev -- --verbose` - shows detailed step-by-step progress
5. Check success screen appears with ASCII art, command count, paths, next steps
6. Verify colors appear in terminal (if terminal supports colors)
7. Run tests: `npm test` - all existing tests pass
</verification>

<success_criteria>
- [ ] Success screen with ASCII art displays after installation
- [ ] Screen shows commands installed, paths, cache status, next steps, disclaimer
- [ ] Progress messages show timing (e.g., "Detecting... (0.3s)")
- [ ] --quiet flag shows only final result
- [ ] --verbose flag shows detailed progress
- [ ] Colors enhance readability when terminal supports them
- [ ] All existing functionality works unchanged
- [ ] Tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish/07-01-SUMMARY.md`
</output>
