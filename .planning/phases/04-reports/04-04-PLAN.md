---
phase: 04-reports
plan: 04
type: execute
wave: 2
depends_on: [04-01]
files_modified:
  - src/lib/transpilation/orchestrator.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Console report displays specific command/agent/model names that transpiled"
    - "Markdown export includes generated OpenCode config JSON"
  artifacts:
    - path: "src/lib/transpilation/orchestrator.ts"
      provides: "Complete TranspileResult with opencode and transformedArtifacts"
      contains: "transformedArtifacts:"
  key_links:
    - from: "src/lib/transpilation/orchestrator.ts"
      to: "TranspileResult"
      via: "return statement populates opencode and transformedArtifacts"
      pattern: "transformedArtifacts:\\s*\\{"
---

<objective>
Wire orchestrator return to include opencode config and transformedArtifacts metadata

Purpose: Close verification gap - console report shows "(Artifact details not available)" because orchestrator omits data
Output: Orchestrator returns complete TranspileResult enabling reporter and markdown-generator to display artifact details
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-reports/04-VERIFICATION.md

# Types already support these fields
@src/types/index.ts (lines 291-315: TranspileResult interface)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add opencode and transformedArtifacts to orchestrator return</name>
  <files>src/lib/transpilation/orchestrator.ts</files>
  <action>
Update the successful return statement at lines 278-285 to include:
1. opencode: transformResult.opencode (the generated OpenCodeConfig)
2. transformedArtifacts: Extract artifact names from the generated config

The return statement should become:
```typescript
return {
  success: true,
  backupLocation,
  manifestPath,
  errors,
  warnings,
  gaps,
  opencode: transformResult.opencode,
  transformedArtifacts: {
    commands: (transformResult.opencode.commands ?? []).map(c => c.name),
    agents: (transformResult.opencode.agents ?? []).map(a => a.name),
    models: (transformResult.opencode.models ?? []).map(m => m.modelId),
  },
};
```

Note: OpenCodeConfig uses arrays (agents, commands, models), not objects with keys. Extract names using .map() on the arrays directly.

Also add TransformedArtifactsMetadata to the type imports at line 17-22 if not already imported:
```typescript
import type {
  TranspileOptions,
  TranspileResult,
  GFHManifest,
  TransformGaps,
  TransformedArtifactsMetadata,
} from '../../types/index.js';
```

The transformedArtifacts object must match the TransformedArtifactsMetadata interface:
- commands: string[] (extract .name from each OpenCodeCommand)
- agents: string[] (extract .name from each OpenCodeAgent)
- models: string[] (extract .modelId from each OpenCodeModel)
  </action>
  <verify>
1. npm run build succeeds with no TypeScript errors
2. Grep for "transformedArtifacts:" in orchestrator.ts confirms the field is populated
3. Grep for "opencode:" in orchestrator.ts confirms the field is populated in return
4. Grep for "TransformedArtifactsMetadata" in orchestrator.ts imports confirms type is imported
  </verify>
  <done>
Orchestrator return statement includes opencode and transformedArtifacts fields, enabling reporter to display specific artifact names instead of fallback message
  </done>
</task>

</tasks>

<verification>
1. npm run build - TypeScript compiles without errors
2. Manual test: Run `npx tsx src/cli.ts transpile --dry-run` on a GSD directory
3. Verify console output shows specific commands/agents/models instead of "(Artifact details not available)"
</verification>

<success_criteria>
- Orchestrator.ts returns TranspileResult with opencode and transformedArtifacts populated
- Build passes without TypeScript errors
- Reporter can access artifact names from TranspileResult (no more fallback message)
</success_criteria>

<output>
After completion, create `.planning/phases/04-reports/04-04-SUMMARY.md`
</output>
